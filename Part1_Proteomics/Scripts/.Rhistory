ggplot(df, aes(x = ID, y = val, fill = condition)) + geom_boxplot(notch = TRUE,
na.rm = TRUE) + coord_flip() + facet_wrap(~var, ncol = 1) +
labs(x = "", y = expression(log[2] ~ "Intensity")) +
theme_DEP1()
}
pnorm <- plotNormJRW(pieris.se) +
scale_fill_manual(values = myCols)
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)
pnorm
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) + coord_flip()
pnorm
pnumb
pnumb + coord_flip()
plot_numbers
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip()
pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)
pnorm
pnumb
pnumb + pnorm
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip()
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
)
library(patchwork)
pnumb + pnorm
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) + labs(x = "", y = expression(log[2] ~ "Intensity")) +
pnorm
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) + labs(x = "", y = expression(log[2] ~ "Intensity"))
pnorm
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.position="none") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
pnorm
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0))
pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.position="none") +
labs(x = "", y = expression(Log[2] ~ "Abundance"), hjust = 0.5)
pnorm
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0), hjust = 0.5)
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0), just = 0.5)
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0), hjust = 0.5)
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0), hjust = 0)
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0), vjust = 0.5)
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
pnumb
pnumb + pnorm +  plot_layout(guides = "collect")
(pnumb + pnorm) + guide_area() + plot_layout(guides = "collect")
pnumb + pnorm + plot_layout(guides = "collect") & theme(legend.position = 'bottom')
pnumb + pnorm + plot_layout(guides = "collect") + theme(legend.position = 'bottom')
&
pnumb + pnorm + plot_layout(guides = "collect") & theme(legend.position = 'bottom')
pnumb + pnorm + plot_layout(guides = "collect")
library(patchwork)
library(ggplot2)
#myCols <- c("orange2", "skyblue2")
myCols <- c("goldenrod1", "orchid3")
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.position="none") + ggtitle(label = "Protein Abundance") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
pnorm
pnumb + pnorm + plot_layout(guides = "collect")
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),
axis.text.y=element_blank())
pnumb
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5),
axis.text.y=element_blank())
#pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
legend.position="none") + ggtitle(label = "Protein Abundance") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
3pnorm
pnumb + pnorm + plot_layout(guides = "collect")
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
#pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.text.y=element_blank()) +
ggtitle(label = "Protein Abundance") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
#pnorm
pnumb + pnorm + plot_layout(guides = "collect")
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5))
#pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.text.y=element_blank()
legend.position = "none") +
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.text.y=element_blank(),
legend.position = "none") +
ggtitle(label = "Protein Abundance") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
#pnorm
pnumb + pnorm + plot_layout(guides = "collect")
ggsave(plot = outplot, filename = "../Results/Count-Abund_prefilter.pdf",
width = 6, height = 4)
outplot <- pnumb + pnorm + plot_layout(guides = "collect")
ggsave(plot = outplot, filename = "../Results/Count-Abund_prefilter.pdf",
width = 6, height = 4)
? ggsave
ggsave(plot = outplot, filename = "../Results/Count-Abund_prefilter.pdf",
width = 6, height = 4, scale=0.5)
ggsave(plot = outplot, filename = "../Results/Count-Abund_prefilter.pdf",
width = 6, height = 4, scale=2)
#myCols <- c("orange2", "skyblue2")
myCols <- c("goldenrod1", "orchid3")
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
guides(fill=guide_legend(title="Sperm Morph"))
#pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.text.y=element_blank(),
legend.position = "none") +
ggtitle(label = "Protein Abundance") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
#pnorm
outplot <- pnumb + pnorm + plot_layout(guides = "collect")
print(outplot)
library(patchwork)
library(ggplot2)
#myCols <- c("orange2", "skyblue2")
myCols <- c("goldenrod1", "orchid3")
pnumb <- plot_numbers(pieris.se) +
scale_fill_manual(values = myCols) + coord_flip() +
theme(axis.text.x = element_text(angle = 0, hjust = 0.5)) +
guides(fill=guide_legend(title="Sperm morph"))
#pnumb
pnorm <- plot_normalization(pieris.se) +
scale_fill_manual(values = myCols) +
theme(
strip.background = element_blank(),
strip.text.x = element_blank(),
axis.text.y=element_blank(),
legend.position = "none") +
ggtitle(label = "Protein Abundance") +
labs(x = "", y = expression(Log[2] ~ "Abundance"))
#pnorm
outplot <- pnumb + pnorm + plot_layout(guides = "collect")
print(outplot)
ggsave(plot = outplot, filename = "../Results/Count-Abund_prefilter.pdf",
width = 6, height = 4, scale=2)
ggsave(plot = outplot, filename = "../Results/Count-Abund_prefilter.pdf",
width = 6, height = 4, scale=1.8)
suppressMessages(library(DEP))
suppressMessages(library(SummarizedExperiment))
library(ggplot2)
library(kableExtra)
library(patchwork)
load("pieris_DEP_SE_object.RData")
pieris.se <- pieris.se[ , -which(colnames(pieris.se) == "Apyrene_4") ]
pieris.logInt <- assay(pieris.se) # extract raw data of ion intensities into stand alone matrix
# get counts of non-NA observations across Apyrene and Eupyrene
Nobs.apy <- apply( pieris.logInt[, grep(pattern="Apy", x = colnames(pieris.logInt))],  1, function(x){sum(! is.na(x) )} )
Nobs.eup <- apply( pieris.logInt[, grep(pattern="Eup", x = colnames(pieris.logInt))],  1, function(x){sum(! is.na(x) )} )
# append these into SE object rowData
rowData(pieris.se)$Nobs.apy <- Nobs.apy
rowData(pieris.se)$Nobs.eup <- Nobs.eup
#Filter for proteins that are identified in replicates
pieris.filt <- filter_missval(pieris.se, thr = 2)
myCols <- c("goldenrod1", "orchid3")
pcaplot <- plot_pca(pieris.filt, n = 500) +
scale_color_manual(values = myCols) +
guides(shape=guide_legend(title="Replicate",
override.aes = list(size = 3)),
color=guide_legend(title="Sperm morph"),
) +
ggtitle("Principal Component Analysis")
ggsave(plot = pcaplot, filename = "../Results/PCA_filtered.pdf",
width = 5, height = 4, scale = 1.1)
plot_numbers(pieris.filt)
plot_normalization(pieris.filt)
yLims <- c(0,1400)
all.freq <- plot_frequency(pieris.filt) +
labs(title = "All samples") +
scale_y_continuous(breaks = c(seq(0, 1500, 200)), limits = yLims)
apy.freq <- plot_frequency(pieris.filt[,pieris.filt$condition == "Apyrene"]) +
labs(title = "Apyrene") +
scale_y_continuous(breaks = c(seq(0, 1500, 200)), limits = yLims)
eup.freq <- plot_frequency(pieris.filt[,pieris.filt$condition == "Eupyrene"]) +
labs(title = "Eupyrene") +
scale_y_continuous(breaks = c(seq(0, 1500, 200)), limits = yLims)
overlaps <- all.freq + eup.freq + apy.freq  + plot_layout(axis_titles = "collect",
widths = c(3,2.2,2),
axes = "collect")
print(overlaps)
ggsave(filename = "../Results/Overlaps.pdf", plot = overlaps, width = 6, height = 3, scale = 1.3)
sum( apply( is.na(assay(pieris.filt)), 1, any ) )
plot_detect(pieris.filt)
obs.required <- 2
rowData(pieris.filt)$mar <- rowData(pieris.filt)$Nobs.apy >= obs.required & rowData(pieris.filt)$Nobs.eup >= obs.required
# subset to only proteins with any missing values, then tabulate MAR/MNAR
table(rowData(pieris.filt[apply( is.na(assay(pieris.filt)), 1, any )])$mar )
suppressMessages( library(ComplexHeatmap) )
plot_missval.jrw <- function (se, title = "Missing Values Pattern")
{
assertthat::assert_that(inherits(se, "SummarizedExperiment"))
se_assay <- assay(se)
if (!any(is.na(se_assay))) {
stop("No missing values in '", deparse(substitute(se)),
"'", call. = FALSE)
}
#df <- se_assay %>% data.frame(.)
df <- as.data.frame(se_assay)
missval <- df[apply(df, 1, function(x) any(is.na(x))), ]
missval <- ifelse(is.na(missval), 0, 1)
ht2 = Heatmap(missval, col = c("grey90", "black"), column_names_side = "top", cluster_columns = F,
show_row_names = FALSE, show_column_names = TRUE, name = title,
column_names_gp = gpar(fontsize = 10), heatmap_legend_param = list(at = c(0,
1), labels = c("Missing value", "Valid value")))
draw(ht2, heatmap_legend_side = "top")
}
plot_missval.jrw(pieris.filt[rowData(pieris.filt)$mar], title = "MAR proteins")
plot_missval.jrw(pieris.filt[!rowData(pieris.filt)$mar], title = "MNAR proteins")
## Write out plots for publication
pdf(file = "../Results/MissingVals_Heatmaps.pdf", width = 6, height = 4)
plot_missval.jrw(pieris.filt[rowData(pieris.filt)$mar], title = "MAR proteins")
plot_missval.jrw(pieris.filt[!rowData(pieris.filt)$mar], title = "MNAR proteins")
dev.off()
# Find eupyrene specific proteins
rowData(pieris.filt)$specific.eup <- rowData(pieris.filt)$Nobs.eup >= 4 &
rowData(pieris.filt)$Nobs.apy <= 1
sum(rowData(pieris.filt)$specific.eup)
# Find apyrene specific proteins
rowData(pieris.filt)$specific.apy <- rowData(pieris.filt)$Nobs.apy >= 4 &
rowData(pieris.filt)$Nobs.eup <= 1
sum(rowData(pieris.filt)$specific.apy)
# Select all the morph-specific proteins
specific.se <- pieris.filt[ rowData(pieris.filt)$specific.eup | rowData(pieris.filt)$specific.apy, ]
nrow(specific.se)
set.seed(1)
pieris.imp.mle <- impute(se = pieris.filt, fun = "mixed",
randna = rowData(pieris.filt)$mar,
mar = "MLE", mnar = "MinDet" )
plot_imputation(pieris.imp.mle)
apy_meanAbundance <- pieris.imp.mle[ , pieris.imp.mle$condition == "Apyrene"]
assay(apy_meanAbundance)
rowData(pieris.imp.mle)$Means.Apy <- rowMeans(assay(apy_meanAbundance))
eupy_meanAbundance <- pieris.imp.mle[ , pieris.imp.mle$condition == "Eupyrene"]
rowMeans(assay(eupy_meanAbundance))
rowData(pieris.imp.mle)$Means.Eupy <- rowMeans(assay(pieris.imp.mle))
rowData(pieris.imp.mle)$Means.All <- rowMeans(assay(pieris.imp.mle)) #Store in col of rowData
apy_meanAbundance <- pieris.imp.mle[ , pieris.imp.mle$condition == "Apyrene"]
rowData(pieris.imp.mle)$Means.Apy <- rowMeans(assay(apy_meanAbundance))
eupy_meanAbundance <- pieris.imp.mle[ , pieris.imp.mle$condition == "Eupyrene"]
rowData(pieris.imp.mle)$Means.Eupy <- rowMeans(assay(pieris.imp.mle))
rowData(pieris.imp.mle)$Means.All <- rowMeans(assay(pieris.imp.mle)) #Store in col of rowData
do.de.se <- function(my.se, alpha = 0.05, lfc = log2(1.5)) {
my.se <- test_diff(se = my.se, type = "all")
my.se <- add_rejections(diff = my.se, alpha = alpha, lfc = lfc)
rowData(my.se)$Apyrene_vs_Eupyrene_p.bh <- p.adjust(rowData(my.se)$Apyrene_vs_Eupyrene_p.val, method = "BH")
rowData(my.se)$significant_bh <- ifelse(rowData(my.se)$Apyrene_vs_Eupyrene_p.bh <= alpha & abs(rowData(my.se)$Apyrene_vs_Eupyrene_diff) >= lfc, TRUE, FALSE )
return(my.se)
}
pieris.imp.mle <- do.de.se(pieris.imp.mle)
par(mfrow=c(1,2))
plot(x = rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_p.adj,
y=rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_p.bh,
xlab = "DEP adjusted P-value", ylab = "BH FDR P-value",
main = "Adjusted P-values:  DEP vs BH", pch = 19, cex = 0.5)
bh.signif <- rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_p.bh < 0.05
plot(x = rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_p.adj[bh.signif],
y = rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_p.bh[bh.signif],
xlab = "DEP adjusted P-value", ylab = "BH FDR P-value",
main = "Adjusted P-values:  DEP vs BH", pch = 19, cex = 0.5)
abline(a = 0, b = 1, lty = 2, col = "red")
#BH FDR significance
table(rowData(pieris.imp.mle)$significant_bh, useNA = "always")
pieris.hack <- pieris.imp.mle
rowData(pieris.hack)$Apyrene_vs_Eupyrene_p.adj <- rowData(pieris.hack)$Apyrene_vs_Eupyrene_p.bh
rowData(pieris.hack)$Apyrene_vs_Eupyrene_significant <- rowData(pieris.hack)$significant_bh
rowData(pieris.hack)$significant <- rowData(pieris.hack)$significant_bh
plot_cor(pieris.hack)
# Plot heatmap of significantly DE proteins
plot_heatmap(pieris.hack, type = "centered", show_row_names = FALSE, indicate = "condition")
plot_volcano(pieris.hack, contrast = "Apyrene_vs_Eupyrene", add_names = F)
plot_pca(pieris.hack)
# Create a vector for calling result (apyrene-biased//eupyrene-biased or not)
# Start with all "unbaised". Then assign results based on "qualitative" assessment
master.de <- rep("unbiased", times = nrow(pieris.imp.mle))
master.de[rowData(pieris.imp.mle)$specific.apy] <- "apyrene"
master.de[rowData(pieris.imp.mle)$specific.eup] <- "eupyrene"
# Now add on result based on statistical support
master.de[rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_diff > 0 &
rowData(pieris.imp.mle)$significant_bh] <- "apyrene"
master.de[rowData(pieris.imp.mle)$Apyrene_vs_Eupyrene_diff < 0 &
rowData(pieris.imp.mle)$significant_bh] <- "eupyrene"
rowData(pieris.imp.mle)$master.de <- master.de
pierisSpermProtDiffEx <- as.data.frame(rowData(pieris.imp.mle))
apyGenes <- length(unique(pierisSpermProtDiffEx$GeneID[
pierisSpermProtDiffEx$master.de == "apyrene"] ))
eupGenes <- length(unique(pierisSpermProtDiffEx$GeneID[
pierisSpermProtDiffEx$master.de == "eupyrene"] ))
unbGenes <- length(unique(pierisSpermProtDiffEx$GeneID[
pierisSpermProtDiffEx$master.de == "unbiased"] ))
apyGenes
eupGenes
unbGenes
knitr::opts_chunk$set(echo = TRUE)
# Read in results from ProteinOrtho.  Missing genes are listed as "*", so set to NA
orthos <- read.delim("../Inputs/Prap_Msex_Dple.proteinortho.tsv", na.strings = '*')
names(orthos) <- c("nSpecies", "nGenes", "score", "Dple", "Msex", "Prap")  # clean up column names.
# How many orthogroups?
nrow(orthos)
# How many orthogroups missing in each species?
sapply(orthos[,4:6], function(x) {sum(is.na(x))})
# Clean up names of identifiers
orthos$DpleGene <- gsub(x =  orthos$Dple, pattern="-PA", replacement = "", fixed = T) # create a column of gene IDs stripped of -PA suffix.
orthos$MsexGene <- gsub(x =  orthos$Msex, pattern="-R\\w", replacement = "", perl = T) # create a column of gene IDs for manduca stripped of -R* suffix.
# now I need to split any paralogs, duplicating entries for the matching species
prap.ortho.long <- data.frame() # create empty DF for filling up
prap.ortho.long$Prap <- character(0) # add on additional column for unique, separated Dplex genes.
prap.ortho.long$Dple <- character(0) # add on additional column for CSV monarch homologs
prap.ortho.long$Msex <- character(0) # add on additional column for CSV manduca homologs
# unwrap paralogs for dplex, so each row has one dplex gene
for (i in seq_len(nrow(orthos)) ) { #
ogs.vec <- strsplit(orthos$Prap[i], split=",", fixed=T)[[1]]  # split csv into vector
for (j in seq_along(ogs.vec)) {  # for each split pieris id
prap.ortho.long <- rbind(prap.ortho.long, data.frame("Prap"= ogs.vec[j], orthos[i,c("DpleGene","MsexGene")]))  # add row with associated orthogroups
}
}
# Load Trx-Gene relation
prapIDtable <- read.csv(file = "../../Part0_DataCleaning/Results/TrxID.GeneName.GeneID.csv")
prap.ortho.long.gene <- merge(x = prapIDtable, y = prap.ortho.long,
by.x = "TrxID" , by.y = "Prap")
dim(prap.ortho.long)
apply(prap.ortho.long, 2, function(x) sum(is.na(x)))
dim(prap.ortho.long.gene)
apply(prap.ortho.long.gene, 2, function(x) sum(is.na(x)))
write.table(x = prap.ortho.long, file = "../Results/Prap_Msex_Dple-protorth-long.txt",
sep = "\t", quote = F, row.names = F)
write.table(x = prap.ortho.long.gene, file = "../Results/Prap_Msex_Dple-protorthGene-long.txt",
sep = "\t", quote = F, row.names = F)
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../Part2_Function/Results/PANNZER.BLAST.DE_Merged.csv")
# Now limit orthologs to ONLY proteins detected in proteomics.
# Need to operate on GeneID, cause arbitrary choices made about
# which transcripts were used in orthology. So remove Trx from this
# because it reflects orthology transcript, not sperm transcript
ProteinOrthoSpermGene <- prap.ortho.long.gene[
prap.ortho.long.gene$GeneID %in% spermProts$GeneID, -1]
write.csv(x = ProteinOrthoSpermGene, file = "../Results/ProteinOrthoSpermGene.csv")
# Number of Pieris sperm genes
nSpermGenes <- length(unique(spermProts$GeneID))
# Number of Pieris sperm genes with orthologs
nSpermGenesWithOrthos <- nrow(ProteinOrthoSpermGene)
print(nSpermGenes)
print(nSpermGenesWithOrthos)
nSpermGenes - nSpermGenesWithOrthos
# Number of proteins without orthologs in monarch or manduca
apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
# Number of Pieris sperm genes with orthologs
nSpermGenesWithOrthos <- nrow(ProteinOrthoSpermGene)
nSpermGenesLackOrthos <- nSpermGenes - nSpermGenesWithOrthos
print(nSpermGenesWithOrthos)
print(nSpermGenesLackOrthos)
# Number of proteins without orthologs in monarch or manduca
nSpermGenesBySpp <- apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
print(nSpermGenesBySpp)
sum(MissingSpermGenesBySpp)
# Number of proteins without orthologs in monarch or manduca
nSpermGenesBySpp <- apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
sum(MissingSpermGenesBySpp)
# Number of proteins without orthologs in monarch or manduca
MissingSpermGenesBySpp <- apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
sum(MissingSpermGenesBySpp)
head(ProteinOrthoSpermGene)
dim(ProteinOrthoSpermGene)
# Number of proteins without orthologs in monarch or manduca
MissingSpermGenesBySpp <- apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
MissingSpermGenesBySpp
MissingSpermGenesBySpp["DpleGene"]
head(monarchSpermProteomeTbl)
#Read in sperm proteome tables from Msex and Dplex
monarchSpermProteomeTbl <- read.csv(file = "../Inputs/monarchSpermProteome.csv", header = TRUE)
manducaSpermProteomeTbl <- read.csv(file = "../Inputs/manducaSpermProteome.csv", header = TRUE)
#Custom Function
# This function cross-references manduca|monarch orthologs or pieiris with sperm
# protein list, returning T if any are sperm prots.
# `qry` is a set of one or more manduca|monarch proteins orthologous to pieris sperm prot; will be CSV.
# `ref` is the complete list of manduca|monarch sperm proteins
xrefSpermProts <- function(qry, ref) {
qryvec <- unlist(strsplit(x = qry, split = ","))
isSperm <- any( qryvec %in% ref)
#If it is a sperm protein, where is it found?
return(isSperm)
}
# test case:  DPOGS203334,DPOGS214479
testcase <- ProteinOrthoSpermGene$DpleGene[122]
print(testcase)
# Positive test case; at least one monarch proteins is in sperm
xrefSpermProts(qry = testcase, ref = monarchSpermProteomeTbl$Gene)
# Negative test case, where it can't possibly match a sperm geneID in monarch
xrefSpermProts(qry = "RockChalk", ref = monarchSpermProteomeTbl$Gene)
# applied to all monarch orthologs of pieris proteins reported by ProtOrtho.
allMonarch <- sapply(ProteinOrthoSpermGene$DpleGene, function(x) {
xrefSpermProts(qry = x, ref = monarchSpermProteomeTbl$Gene)})
# applied to all manduca orthologs of pieris proteins reported by ProtOrtho.
allManduca <- sapply(ProteinOrthoSpermGene$MsexGene, function(x) {
xrefSpermProts(qry = x, ref = manducaSpermProteomeTbl$Gene)})
#Ortholog Detection - tabulated how many pieris proteins are found to have sperm-homologs in Monarch|Manduca.
nDpleSpermHom <- sum(allMonarch)
nMsexSpermHom <- sum(allManduca)
SpermHomCounts <- c(nMsexSpermHom, nDpleSpermHom)
names(SpermHomCounts) <- c("Manduca", "Danaus")
print(SpermHomCounts)
head(manducaSpermProteomeTbl)
nrow(manducaSpermProteomeTbl)
nrow(monarchSpermProteomeTbl)
nMsexSpermHom/nrow(manducaSpermProteomeTbl)
nDpleSpermHom/nrow(monarchSpermProteomeTbl)
24*15
1000/50
* 15
1000/50 * 15
e^0.2
exp(0.2)
log(0.7)
