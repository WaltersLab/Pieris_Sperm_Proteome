? write.table
write.table(x = prap.ortho.long, file = "../Results/Prap_Msex_Dple-protorth-long.txt",
sep = "\t", quote = F, row.names = F)
# Update name of parsed orthology object, cause merging different scripts here...
ProteinOrthoOutput <- prap.ortho.long
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../02_Function/Results/PANNZER.BLAST.DE_Merged.csv")
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../../02_Function/Results/PANNZER.BLAST.DE_Merged.csv")
getwd()
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../Part2_Function/Results/PANNZER.BLAST.DE_Merged.csv")
# Update name of parsed orthology object, cause merging different scripts here...
ProteinOrthoOutput <- prap.ortho.long
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../Part2_Function/Results/PANNZER.BLAST.DE_Merged.csv")
# Now limit ProteinOrthoOutput to ONLY proteins detected in proteomics.
# gets ProteinOrtho results for ONLY sperm proteins.
ProteinOrthoSperm <- ProteinOrthoOutput[ProteinOrthoOutput$Prap %in% spermProts$TrxID,]
write.csv(x = ProteinOrthoSperm, file = "../Results/ProteinOrthoSperm.csv")
# number of Sperm prots without orthologs predicted by ProteinOrtho
nrow(spermProts) - nrow(ProteinOrthoSperm)
spermOrphans_ProtOrth <- spermProts[ ! spermProts$TrxID %in% ProteinOrthoSperm$Prap, ]  # get details of sperm prots w/o orthologs
write.csv(x = spermOrphans_ProtOrth, file = "/Users/katiemclaughlin/OneDrive - University of Kansas/PierisProteomeProject/Analysis_Results/Homology/spermOrphanProts_LepProtOrtho.csv")
# number of Sperm prots without orthologs predicted by ProteinOrtho
nrow(spermProts) - nrow(ProteinOrthoSperm)
spermOrphans_ProtOrth <- spermProts[ ! spermProts$TrxID %in% ProteinOrthoSperm$Prap, ]  # get details of sperm prots w/o orthologs
write.csv(x = spermOrphans_ProtOrth, file = "../Results/spermOrphanProts_LepProtOrtho.csv")
# number of Sperm prots without orthologs predicted by ProteinOrtho
nrow(spermProts) - nrow(ProteinOrthoSperm)
spermOrphans_ProtOrth <- spermProts[ ! spermProts$TrxID %in% ProteinOrthoSperm$Prap, ]  # get details of sperm prots w/o orthologs
write.csv(x = spermOrphans_ProtOrth, file = "../Results/spermOrphanProts_LepProtOrtho.csv")
#Proteins with zero orthologs in Manduca
ManducaNA <- sum(is.na(ProteinOrthoSperm$MsexGene))
ManducaNA
View(ProteinOrthoSperm)
#Proteins with zero orthologs in Manduca
ManducaNA <- sum(is.na(ProteinOrthoSperm$MsexGene))
#Proteins with zero orthologs in Monarch
MonarchNA <- sum(is.na(ProteinOrthoSperm$DpleGene))
oneSppNA <- c(ManducaNA, MonarchNA)
names(oneSppNA) <- c("Manduca", "Danaus")
print(oneSppNA)
#Read in sperm proteome tables from Msex and Dplex
monarchSpermProteomeTbl <- read.csv(file = "../Inputs/monarchSpermProteome.csv", header = TRUE)
manducaSpermProteomeTbl <- read.csv(file = "../Inputs/manducaSpermProteome.csv", header = TRUE)
dim(ProteinOrthoSperm)
ProteinOrthoSperm$DpleGene[1]
print(ProteinOrthoSperm$DpleGene[1])
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = ProteinOrthoSperm$DpleGene[1], ref = monarchSpermProteomeTbl$Gene)
#Custom Function
# This function cross-references manduca|monarch orthologs or pieiris with sperm
# protein list, returning T if any are sperm prots.
# `qry` is a set of one or more manduca|monarch proteins orthologous to pieris sperm prot; will be CSV.
# `ref` is the complete list of manduca|monarch sperm proteins
xrefSpermProts <- function(qry, ref) {
qryvec <- unlist(strsplit(x = qry, split = ","))
isSperm <- any( qryvec %in% ref)
#If it is a sperm protein, where is it found?
return(isSperm)
}
print(ProteinOrthoSperm$DpleGene[1])
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = ProteinOrthoSperm$DpleGene[1], ref = monarchSpermProteomeTbl$Gene)
# Negative test case, where it can't possibly match a sperm geneID in monarch
xrefSpermProts(qry = "RockChalk", ref = monarchSpermProteomeTbl$Gene)
# applied to all monarch orthologs of pieris proteins reported by ProtOrtho.
allMonarch <- sapply(ProteinOrthoSperm$DpleGene, function(x) {
xrefSpermProts(qry = x, ref = monarchSpermProteomeTbl$Gene)})
# applied to all manduca orthologs of pieris proteins reported by ProtOrtho.
allManduca <- sapply(ProteinOrthoSperm$MsexGene, function(x) {
xrefSpermProts(qry = x, ref = manducaSpermProteomeTbl$Gene)})
#Ortholog Detection - tabulated how many pieris proteins are found to have sperm-homologs in Monarch|Manduca.
sum(complete.cases(ProteinOrthoSperm$DpleGene)) #1219
sum(complete.cases(ProteinOrthoSperm$MsexGene)) #1190
nDpleSpermHom <- sum(complete.cases(ProteinOrthoSperm$DpleGene))
nMsexSpermHom <- sum(complete.cases(ProteinOrthoSperm$MsexGene))
SpermHomCounts <- c(nMsexSpermHom, nDpleSpermHom)
names(SpermHomCounts) <- c("Manduca", "Danaus")
print(SpermHomCounts)
allManduca
colnames(ProteinOrthoSperm)
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSperm["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSperm["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSperm)
# Rearrange column names to group species
ProteinOrthoSperm_Reordered <- ProteinOrthoSperm[, c(1, 2, 4, 3, 5)]
colnames(ProteinOrthoSperm)
# Rearrange column names to group species
ProteinOrthoSperm_Reordered <- ProteinOrthoSperm[, c(1, 2, 4, 3, 5)]
names(ProteinOrthoSperm_Reordered)
#Merge in GeneID into ProteinOrthoSperm (from GeneID.TrxID csv)
GeneID.TrxID.Table <- read.csv(file = "../../Part0_DataCleaning/Results/longestCDS_TrxID.GeneName.GeneID.csv", header = TRUE)
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSperm["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSperm["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSperm)
# Rearrange column names to group species
ProteinOrthoSperm_Reordered <- ProteinOrthoSperm[, c(1, 2, 4, 3, 5)]
#Merge in GeneID into ProteinOrthoSperm (from GeneID.TrxID csv)
GeneID.TrxID.Table <- read.csv(file = "../../Part0_DataCleaning/Results/longestCDS_TrxID.GeneName.GeneID.csv", header = TRUE)
ProteinOrthoSperm_Final <- merge(x = ProteinOrthoSperm_Reordered,
y = GeneID.TrxID.Table, by.x = "Prap",
by.y = "TranscriptID")
#Remove GeneNames
ProteinOrthoSperm_Final = subset(ProteinOrthoSperm_Final, select = -c(7) )
# Merge orthology & sperm homology results into "master" dataframe of sperm proteomics results with annotations.
Homology_MasterDF <- merge(y = ProteinOrthoSperm_Final, x = spermProts,
by.x = "GeneID", by.y = "GeneID", all.x = TRUE)
#Write out to file
write.csv(Homology_MasterDF, file = "/../Results/HomologyMasterDF.csv")
#Write out to file
write.csv(Homology_MasterDF, file = "../../Results/HomologyMasterDF.csv")
#Write out to file
write.csv(Homology_MasterDF, file = "../Results/HomologyMasterDF.csv")
View(Homology_MasterDF)
#Monarch
monarchHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Monarch)
monarchHomologs
# chisq.test(monarchHomologs)
fisher.test(monarchHomologs) #significant differences
MonarchHomologResults
monarch.HomologProp <- prop.table(monarchHomologs, margin = 1) #proportions - Eupyrene are most conserved
MonarchHomologResults <- cbind(monarchHomologs, monarch.HomologProp)
MonarchHomologResults
kable(MonarchHomologResults)
#Manduca
manducaHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Manduca)
fisher.test(manducaHomologs)
manduca.HomologProp <- prop.table(manducaHomologs, margin = 1)
#Write out to file
ManducaHomologResults <- cbind(manducaHomologs, manduca.HomologProp)
#Write out to file
write.csv(ManducaHomologResults, file = "../Results/ManducaHomologCounts.csv")
kable(ManducaHomologResults)
kable(round(ManducaHomologResults, 3)
kable(round(ManducaHomologResults, 3))
kable(round(ManducaHomologResults, 3))
#Manduca
manducaHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Manduca)
fisher.test(manducaHomologs)
manduca.HomologProp <- prop.table(manducaHomologs, margin = 1)
#Write out to file
ManducaHomologResults <- cbind(manducaHomologs, manduca.HomologProp)
#Write out to file
write.csv(ManducaHomologResults, file = "../Results/ManducaHomologCounts.csv")
kable(round(ManducaHomologResults, 3))
#Monarch
monarchHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Monarch)
fisher.test(monarchHomologs) #significant differences
monarch.HomologProp <- prop.table(monarchHomologs, margin = 1) #proportions - Eupyrene are most conserved
MonarchHomologResults <- cbind(monarchHomologs, monarch.HomologProp)
#Write out to file
write.csv(MonarchHomologResults, file = "../Results/MonarchHomologCounts.csv")
kable(round(MonarchHomologResults, 3))
duplicated(Homology_MasterDF$GeneID)
#Remove duplicate copies of isoforms
isoforms <- duplicated(Homology_MasterDF$GeneID)
sum(kable(MonarchHomologResults))
sum(isoforms)
isoforms <- duplicated(ProteinOrthoSperm$GeneID)
ProteinOrthoSperm[isoforms, ]
isoforms
ProteinOrthoSperm
ProteinOrthoSperm$GeneID
head(orthos)
prapIDtable <- read.csv(file = "../../Part0_DataCleaning/Results/TrxID.GeneName.GeneID.csv")
head(prapIDtable)
prap.ortho.long.gene <- merge(x = prap.ortho.long, y = prapIDtable,
by.x = "TrxID" , by.y = "Prap")
prap.ortho.long.gene <- merge(y = prap.ortho.long, x = prapIDtable,
by.x = "TrxID" , by.y = "Prap")
write.table(x = prap.ortho.long.gene, file = "../Results/Prap_Msex_Dple-protorthGene-long.txt",
sep = "\t", quote = F, row.names = F)
dim(prap.ortho.long)
dim(prap.ortho.long.gene)
dim(prap.ortho.long)
apply(prap.ortho.long, 2, function(x) sum(is.na(x)))
dim(prap.ortho.long)
apply(prap.ortho.long, 2, function(x) sum(is.na(x)))
dim(prap.ortho.long.gene)
apply(prap.ortho.long.gene, 2, function(x) sum(is.na(x)))
prap.ortho.long.gene[is.na(prap.ortho.long.gene$GeneID),]
apply(prap.ortho.long.gene, 2, function(x) sum(is.na(x)))
prap.ortho.long.gene[is.na(prap.ortho.long.gene$GeneName),]
dim(ProteinOrthoSperm)
ProteinOrthoSpermGene <- ProteinOrthoOutput[prap.ortho.long.gene$GeneID %in% spermProts$GeneID,]
dim(ProteinOrthoSpermGene)
dim(spermProts)
length(unique(spermProts$GeneID))
# Now limit orthologs to ONLY proteins detected in proteomics.
# Need to operate on GeneID, cause arbitrary choices we
ProteinOrthoSpermGene <- prap.ortho.long.gene$GeneID[
prap.ortho.long.gene$GeneID %in% spermProts$GeneID,]
# Now limit orthologs to ONLY proteins detected in proteomics.
# Need to operate on GeneID, cause arbitrary choices we
ProteinOrthoSpermGene <- prap.ortho.long.gene[
prap.ortho.long.gene$GeneID %in% spermProts$GeneID,]
dim(ProteinOrthoSpermGene)
isoforms <- duplicated(ProteinOrthoSpermGene$GeneID)
ProteinOrthoSpermGene[isoforms, ]
write.csv(x = ProteinOrthoSpermGene, file = "../Results/ProteinOrthoSpermGene.csv")
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../Part2_Function/Results/PANNZER.BLAST.DE_Merged.csv")
# Now limit orthologs to ONLY proteins detected in proteomics.
# Need to operate on GeneID, cause arbitrary choices made about
# which transcripts were used in orthology. So remove Trx from this
# because it reflects orthology transcript, not sperm transcript
ProteinOrthoSpermGene <- prap.ortho.long.gene[
prap.ortho.long.gene$GeneID %in% spermProts$GeneID, -1]
write.csv(x = ProteinOrthoSpermGene, file = "../Results/ProteinOrthoSpermGene.csv")
sum(duplicated(ProteinOrthoSpermGene$GeneID))
nrow(spermProts)
length(unique(spermProts$GeneID))
nrow(ProteinOrthoSpermGene)
apply(ProteinOrthoSpermGene, 2, function(x) sum(is.na(x)))
# Number of Pieris sperm genes
nSpermGenes <- length(unique(spermProts$GeneID))
# Number of Pieris sperm genes with orthologs
nSpermGenesWithOrthos <- nrow(ProteinOrthoSpermGene)
print(nSpermGenes)
print(nSpermGenesWithOrthos)
# Number of proteins without orthologs in monarch or manduca
apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
# Number of Pieris sperm genes
nSpermGenes <- length(unique(spermProts$GeneID))
# Number of Pieris sperm genes with orthologs
nSpermGenesWithOrthos <- nrow(ProteinOrthoSpermGene)
print(nSpermGenes)
print(nSpermGenesWithOrthos)
nSpermGenes - nSpermGenesWithOrthos
# Number of proteins without orthologs in monarch or manduca
apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
sum(duplicated(ProteinOrthoSpermGene$GeneID))
# get details of sperm prots w/o orthologs
spermOrphans_ProtOrth <- spermProts[ ! spermProts$GeneID %in%
ProteinOrthoSpermGene$GeneID, ]
dim(spermOrphans_ProtOrth)
# get details of sperm prots w/o orthologs
spermOrphans_ProtOrth <- spermProts[ ! spermProts$GeneID %in%
ProteinOrthoSpermGene$GeneID, ]
write.csv(x = spermOrphans_ProtOrth, file = "../Results/spermOrphanProts_LepProtOrtho.csv")
#Proteins with zero orthologs in Manduca
ManducaNA <- sum(is.na(ProteinOrthoSpermGene$MsexGene))
#Proteins with zero orthologs in Monarch
MonarchNA <- sum(is.na(ProteinOrthoSpermGene$DpleGene))
oneSppNA <- c(ManducaNA, MonarchNA)
names(oneSppNA) <- c("Manduca", "Danaus")
print(oneSppNA)
print(ProteinOrthoSperm$DpleGene[1])
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = ProteinOrthoSpermGene$DpleGene[1], ref = monarchSpermProteomeTbl$Gene)
# Negative test case, where it can't possibly match a sperm geneID in monarch
xrefSpermProts(qry = "RockChalk", ref = monarchSpermProteomeTbl$Gene)
# applied to all monarch orthologs of pieris proteins reported by ProtOrtho.
allMonarch <- sapply(ProteinOrthoSpermGene$DpleGene, function(x) {
xrefSpermProts(qry = x, ref = monarchSpermProteomeTbl$Gene)})
# applied to all manduca orthologs of pieris proteins reported by ProtOrtho.
allManduca <- sapply(ProteinOrthoSpermGene$MsexGene, function(x) {
xrefSpermProts(qry = x, ref = manducaSpermProteomeTbl$Gene)})
#Ortholog Detection - tabulated how many pieris proteins are found to have sperm-homologs in Monarch|Manduca.
nDpleSpermHom <- sum(complete.cases(ProteinOrthoSpermGene$DpleGene))
nMsexSpermHom <- sum(complete.cases(ProteinOrthoSpermGene$MsexGene))
SpermHomCounts <- c(nMsexSpermHom, nDpleSpermHom)
names(SpermHomCounts) <- c("Manduca", "Danaus")
print(SpermHomCounts)
head(ProteinOrthoSpermGene)
ProteinOrthoSpermGene$DpleGene
sum(is.na(ProteinOrthoSpermGene$DpleGene))
length(is.na(ProteinOrthoSpermGene$DpleGene))
1366-91
print(SpermHomCounts)
head(ProteinOrthoSpermGene)
ProteinOrthoSpermGene["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSpermGene["spermProteomePresence_Manduca"] <- allManduca
head(ProteinOrthoSpermGene)
View(ProteinOrthoSpermGene)
colnames(ProteinOrthoSperm)
colnames(ProteinOrthoSpermGene)
# Merge orthology & sperm homology results into "master" dataframe of sperm proteomics results with annotations.
Homology_MasterDF <- merge(x = spermProts, y = ProteinOrthoSperm_Final,
by.x = "GeneID", by.y = "GeneID", all.x = TRUE)
dim(Homology_MasterDF)
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSpermGene["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSpermGene["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSpermGene)
# Rearrange column names to group species results together
# Drop GeneName, since it is redundant when merged back in.
ProteinOrthoSperm_Reordered <- ProteinOrthoSperm[, c(2, 3, 5, 4, 6)]
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSpermGene["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSpermGene["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSpermGene)
# Rearrange column names to group species results together
# Drop GeneName, since it is redundant when merged back in.
ProteinOrthoSperm_Reordered <- ProteinOrthoSperm[, c(2, 3, 5, 4, 6)]
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSpermGene["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSpermGene["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSpermGene)
# Rearrange column names to group species results together
# Drop GeneName, since it is redundant when merged back in.
ProteinOrthoSperm_Reordered <- ProteinOrthoSpermGene[, c(2, 3, 5, 4, 6)]
# Merge orthology & sperm homology results into "master" dataframe of sperm proteomics results with annotations.
Homology_MasterDF <- merge(x = spermProts, y = ProteinOrthoSperm_Final,
by.x = "GeneID", by.y = "GeneID", all.x = TRUE)
#Write out to file
write.csv(Homology_MasterDF, file = "../Results/HomologyMasterDF.csv")
#Monarch
monarchHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Monarch)
fisher.test(monarchHomologs) #significant differences
monarch.HomologProp <- prop.table(monarchHomologs, margin = 1) #proportions - Eupyrene are most conserved
MonarchHomologResults <- cbind(monarchHomologs, monarch.HomologProp)
#Write out to file
write.csv(MonarchHomologResults, file = "../Results/MonarchHomologCounts.csv")
kable(round(MonarchHomologResults, 3))
#Manduca
manducaHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Manduca)
fisher.test(manducaHomologs)
manduca.HomologProp <- prop.table(manducaHomologs, margin = 1)
#Write out to file
ManducaHomologResults <- cbind(manducaHomologs, manduca.HomologProp)
#Write out to file
write.csv(ManducaHomologResults, file = "../Results/ManducaHomologCounts.csv")
kable(round(ManducaHomologResults, 3))
View(orthos)
# Read in results from ProteinOrtho.  Missing genes are listed as "*", so set to NA
orthos <- read.delim("../Inputs/Prap_Msex_Dple.proteinortho.tsv", na.strings = '*')
names(orthos) <- c("nSpecies", "nGenes", "score", "Dple", "Msex", "Prap")  # clean up column names.
# How many orthogroups?
nrow(orthos)
# How many orthogroups missing in each species?
sapply(orthos[,4:6], function(x) {sum(is.na(x))})
# Clean up names of identifiers
orthos$DpleGene <- gsub(x =  orthos$Dple, pattern="-PA", replacement = "", fixed = T) # create a column of gene IDs stripped of -PA suffix.
orthos$MsexGene <- gsub(x =  orthos$Msex, pattern="-R\\w", replacement = "", perl = T) # create a column of gene IDs for manduca stripped of -R* suffix.
# Read in results from ProteinOrtho.  Missing genes are listed as "*", so set to NA
orthos <- read.delim("../Inputs/Prap_Msex_Dple.proteinortho.tsv", na.strings = '*')
names(orthos) <- c("nSpecies", "nGenes", "score", "Dple", "Msex", "Prap")  # clean up column names.
# How many orthogroups?
nrow(orthos)
# How many orthogroups missing in each species?
sapply(orthos[,4:6], function(x) {sum(is.na(x))})
# Clean up names of identifiers
orthos$DpleGene <- gsub(x =  orthos$Dple, pattern="-PA", replacement = "", fixed = T) # create a column of gene IDs stripped of -PA suffix.
orthos$MsexGene <- gsub(x =  orthos$Msex, pattern="-R\\w", replacement = "", perl = T) # create a column of gene IDs for manduca stripped of -R* suffix.
# now I need to split any paralogs, duplicating entries for the matching species
prap.ortho.long <- data.frame() # create empty DF for filling up
prap.ortho.long$Prap <- character(0) # add on additional column for unique, separated Dplex genes.
prap.ortho.long$Dple <- character(0) # add on additional column for CSV monarch homologs
prap.ortho.long$Msex <- character(0) # add on additional column for CSV manduca homologs
# unwrap paralogs for dplex, so each row has one dplex gene
for (i in seq_len(nrow(orthos)) ) { #
ogs.vec <- strsplit(orthos$Prap[i], split=",", fixed=T)[[1]]  # split csv into vector
for (j in seq_along(ogs.vec)) {  # for each split pieris id
prap.ortho.long <- rbind(prap.ortho.long, data.frame("Prap"= ogs.vec[j], orthos[i,c("DpleGene","MsexGene")]))  # add row with associated orthogroups
}
}
# Load Trx-Gene relation
prapIDtable <- read.csv(file = "../../Part0_DataCleaning/Results/TrxID.GeneName.GeneID.csv")
prap.ortho.long.gene <- merge(x = prapIDtable, y = prap.ortho.long,
by.x = "TrxID" , by.y = "Prap")
dim(prap.ortho.long)
apply(prap.ortho.long, 2, function(x) sum(is.na(x)))
dim(prap.ortho.long.gene)
apply(prap.ortho.long.gene, 2, function(x) sum(is.na(x)))
write.table(x = prap.ortho.long, file = "../Results/Prap_Msex_Dple-protorth-long.txt",
sep = "\t", quote = F, row.names = F)
write.table(x = prap.ortho.long.gene, file = "../Results/Prap_Msex_Dple-protorthGene-long.txt",
sep = "\t", quote = F, row.names = F)
# this is the set of identified Pieris sperm proteins from MS.
spermProts <- read.csv(file = "../../Part2_Function/Results/PANNZER.BLAST.DE_Merged.csv")
# Now limit orthologs to ONLY proteins detected in proteomics.
# Need to operate on GeneID, cause arbitrary choices made about
# which transcripts were used in orthology. So remove Trx from this
# because it reflects orthology transcript, not sperm transcript
ProteinOrthoSpermGene <- prap.ortho.long.gene[
prap.ortho.long.gene$GeneID %in% spermProts$GeneID, -1]
write.csv(x = ProteinOrthoSpermGene, file = "../Results/ProteinOrthoSpermGene.csv")
# Number of Pieris sperm genes
nSpermGenes <- length(unique(spermProts$GeneID))
# Number of Pieris sperm genes with orthologs
nSpermGenesWithOrthos <- nrow(ProteinOrthoSpermGene)
print(nSpermGenes)
print(nSpermGenesWithOrthos)
nSpermGenes - nSpermGenesWithOrthos
# Number of proteins without orthologs in monarch or manduca
apply(ProteinOrthoSpermGene[3:4], 2, function(x) sum(is.na(x)))
# get details of sperm prots w/o orthologs
spermOrphans_ProtOrth <- spermProts[ ! spermProts$GeneID %in%
ProteinOrthoSpermGene$GeneID, ]
write.csv(x = spermOrphans_ProtOrth, file = "../Results/spermOrphanProts_LepProtOrtho.csv")
#Read in sperm proteome tables from Msex and Dplex
monarchSpermProteomeTbl <- read.csv(file = "../Inputs/monarchSpermProteome.csv", header = TRUE)
manducaSpermProteomeTbl <- read.csv(file = "../Inputs/manducaSpermProteome.csv", header = TRUE)
#Custom Function
# This function cross-references manduca|monarch orthologs or pieiris with sperm
# protein list, returning T if any are sperm prots.
# `qry` is a set of one or more manduca|monarch proteins orthologous to pieris sperm prot; will be CSV.
# `ref` is the complete list of manduca|monarch sperm proteins
xrefSpermProts <- function(qry, ref) {
qryvec <- unlist(strsplit(x = qry, split = ","))
isSperm <- any( qryvec %in% ref)
#If it is a sperm protein, where is it found?
return(isSperm)
}
print(ProteinOrthoSperm$DpleGene[1])
print(ProteinOrthoSpermGene$DpleGene[1])
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = ProteinOrthoSpermGene$DpleGene[1], ref = monarchSpermProteomeTbl$Gene)
# Negative test case, where it can't possibly match a sperm geneID in monarch
xrefSpermProts(qry = "RockChalk", ref = monarchSpermProteomeTbl$Gene)
ProteinOrthoSpermGene$DpleGene[1]
head(ProteinOrthoSpermGene)
View(ProteinOrthoSpermGene)
ProteinOrthoSpermGene
testcase <- print(ProteinOrthoSpermGene$DpleGene[1284])
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = testcase, ref = monarchSpermProteomeTbl$Gene)
which(ProteinOrthoSpermGene$DpleGene == "DPOGS203334,DPOGS214479")
# test case:  DPOGS203334,DPOGS214479
testcase <- print(ProteinOrthoSpermGene$DpleGene[122])
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = testcase, ref = monarchSpermProteomeTbl$Gene)
# Negative test case, where it can't possibly match a sperm geneID in monarch
xrefSpermProts(qry = "RockChalk", ref = monarchSpermProteomeTbl$Gene)
# test case:  DPOGS203334,DPOGS214479
testcase <- ProteinOrthoSpermGene$DpleGene[122]
print(testcase)
# Positive test case; turns out first entry is TRUE
xrefSpermProts(qry = testcase, ref = monarchSpermProteomeTbl$Gene)
# Negative test case, where it can't possibly match a sperm geneID in monarch
xrefSpermProts(qry = "RockChalk", ref = monarchSpermProteomeTbl$Gene)
# applied to all monarch orthologs of pieris proteins reported by ProtOrtho.
allMonarch <- sapply(ProteinOrthoSpermGene$DpleGene, function(x) {
xrefSpermProts(qry = x, ref = monarchSpermProteomeTbl$Gene)})
# applied to all manduca orthologs of pieris proteins reported by ProtOrtho.
allManduca <- sapply(ProteinOrthoSpermGene$MsexGene, function(x) {
xrefSpermProts(qry = x, ref = manducaSpermProteomeTbl$Gene)})
#Ortholog Detection - tabulated how many pieris proteins are found to have sperm-homologs in Monarch|Manduca.
nDpleSpermHom <- sum(complete.cases(ProteinOrthoSpermGene$DpleGene))
nMsexSpermHom <- sum(complete.cases(ProteinOrthoSpermGene$MsexGene))
SpermHomCounts <- c(nMsexSpermHom, nDpleSpermHom)
names(SpermHomCounts) <- c("Manduca", "Danaus")
print(SpermHomCounts)
sum(allMonarch)
allMonarch
length(allMonarch)
sum(allMonarch)
sum(allManduca)
# applied to all monarch orthologs of pieris proteins reported by ProtOrtho.
allMonarch <- sapply(ProteinOrthoSpermGene$DpleGene, function(x) {
xrefSpermProts(qry = x, ref = monarchSpermProteomeTbl$Gene)})
# applied to all manduca orthologs of pieris proteins reported by ProtOrtho.
allManduca <- sapply(ProteinOrthoSpermGene$MsexGene, function(x) {
xrefSpermProts(qry = x, ref = manducaSpermProteomeTbl$Gene)})
#Ortholog Detection - tabulated how many pieris proteins are found to have sperm-homologs in Monarch|Manduca.
nDpleSpermHom <- sum(allMonarch)
nMsexSpermHom <- sum(allManduca)
SpermHomCounts <- c(nMsexSpermHom, nDpleSpermHom)
names(SpermHomCounts) <- c("Manduca", "Danaus")
print(SpermHomCounts)
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSpermGene["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSpermGene["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSpermGene)
# Rearrange column names to group species results together
# Drop GeneName, since it is redundant when merged back in.
ProteinOrthoSperm_Reordered <- ProteinOrthoSpermGene[, c(2, 3, 5, 4, 6)]
# Merge orthology & sperm homology results into "master" dataframe of sperm proteomics results with annotations.
Homology_MasterDF <- merge(x = spermProts, y = ProteinOrthoSperm_Final,
by.x = "GeneID", by.y = "GeneID", all.x = TRUE)
# Add results from Monarch & Manduca onto dataframe ProteinOrthoSperm
ProteinOrthoSpermGene["spermProteomePresence_Monarch"] <- allMonarch
ProteinOrthoSpermGene["spermProteomePresence_Manduca"] <- allManduca
colnames(ProteinOrthoSpermGene)
# Rearrange column names to group species results together
# Drop GeneName, since it is redundant when merged back in.
ProteinOrthoSperm_Reordered <- ProteinOrthoSpermGene[, c(2, 3, 5, 4, 6)]
# Merge orthology & sperm homology results into "master" dataframe of sperm proteomics results with annotations.
Homology_MasterDF <- merge(x = spermProts, y = ProteinOrthoSperm_Reordered,
by.x = "GeneID", by.y = "GeneID", all.x = TRUE)
#Write out to file
write.csv(Homology_MasterDF, file = "../Results/HomologyMasterDF.csv")
#Monarch
monarchHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Monarch)
fisher.test(monarchHomologs) #significant differences
monarch.HomologProp <- prop.table(monarchHomologs, margin = 1) #proportions - Eupyrene are most conserved
MonarchHomologResults <- cbind(monarchHomologs, monarch.HomologProp)
#Write out to file
write.csv(MonarchHomologResults, file = "../Results/MonarchHomologCounts.csv")
kable(round(MonarchHomologResults, 3))
#Manduca
manducaHomologs <- table(Homology_MasterDF$master.de,
Homology_MasterDF$spermProteomePresence_Manduca)
fisher.test(manducaHomologs)
manduca.HomologProp <- prop.table(manducaHomologs, margin = 1)
#Write out to file
ManducaHomologResults <- cbind(manducaHomologs, manduca.HomologProp)
#Write out to file
write.csv(ManducaHomologResults, file = "../Results/ManducaHomologCounts.csv")
kable(round(ManducaHomologResults, 3))
